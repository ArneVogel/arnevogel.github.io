<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Denoising Functions in Matlab With FFT</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Arne Vogel">
<meta name="description" content="Denoising Functions in Matlab With Fourier transform FFT">
<meta property="og:url" content="https://www.arnevogel.com/denoising-functions-in-matlab-with-fft/" />
<meta property="og:title" content="Denoising Functions in Matlab With FFT" />
<link rel="canonical" href="https://www.arnevogel.com/denoising-functions-in-matlab-with-fft/">
<link rel="icon" type="image/png" href="https://www.arnevogel.com/favicon.png" sizes="128x128">
		<link href="https://www.arnevogel.com/style/style.css" rel="stylesheet">
	</head>
	<body>
		<header class="site-header">
	<div class="wrapper">
		<a href="/" class="header-text">
			Arne Vogel
		</a><br>
	</div>
</header>
		<div class="site-content">
	<div class="wrapper">
		

<h1>Denoising Functions in Matlab With FFT</h1>
<span class="list-date">Dec 22, 2017 â€¢ Arne Vogel</span>
<p>Reducing the noise of a signal in Matlab using fast fourier transform.</p>

<p>You can download the Matlab file: <a href="/download/denoise.m">denoise.m</a></p>

<p>The function generating the signal in this post will be:</p>

<p><img src="/images/denoising-functions-in-matlab-with-fft/function.svg" alt="sin(2*t)+cos(7*t)-cos(t)" /></p>

<pre><code>% number of signal measurements
n = 1000;
% measuring from 0 to 2 pi
length = 2*pi;
% difference between two measurements
h = length/n;
% steps
t = (0:h:length-h);
% Signal
S = sin(2*t)+cos(7*t)-cos(t);
</code></pre>

<p>Plot of the signal from 0 to 2*pi.
<img src="/images/denoising-functions-in-matlab-with-fft/signal.png" alt="signal" /></p>

<pre><code>% random noise
RN = randn(n,1);
% adding the random noise to the signal
NS = transpose(RN) + S;
</code></pre>

<p>The signal with added noise.
<img src="/images/denoising-functions-in-matlab-with-fft/noisy_signal.png" alt="noisy signal" /></p>

<pre><code>% getting the complex fourier coefficients using fft
ck = fft(NS);

% dividing the complex fourier coefficients by n 
ck = ck/n;

% setting any complex fourier coefficients smaller than 0.9 times the
% max to zero to remove the noise
m = max(ck);
for i = 1:n
  if ck(i) &lt; 0.9*m
    ck(i) = 0;
  end
end


% getting the fourier coefficients ak and bk
s = floor(n/2)+1;
for i = 1:s
  ak(i) = 2 * real(ck(i));
  bk(i) = -2 * imag(ck(i));
end

% applying the fourier series in sin cos form
tmp = 0;
for i = 1:n
  y(i) = ak(1)/2;
  for j = 2:s
    y(i) += ak(j) * cos((j-1)*i*h) + bk(j) * sin((j-1)*i*h);
  end
end
</code></pre>

<p>Plot of the generated signal:
<img src="/images/denoising-functions-in-matlab-with-fft/generated_signal.png" alt="generated signal" /></p>

<p>Here is a plot of the absulute error of the generated signal minus the analytical signal.</p>

<p><img src="/images/denoising-functions-in-matlab-with-fft/error.png" alt="error" /></p>

<p>Doubling the noise results in a subpar result:</p>

<p><img src="/images/denoising-functions-in-matlab-with-fft/double_noise.png" alt="double noise" /></p>

<p>Reducing the percantage of fourier coefficients to the top 5% however improves the result again:</p>

<p><img src="/images/denoising-functions-in-matlab-with-fft/double_noise_top_5_percent.png" alt="double noise top 5 percent" /></p>







			</div>
</div>
		<footer class="site-footer">
	<div class="wrapper">
		Copyright - Arne Vogel 2017
	</div>
</footer>
	</body>
</html>